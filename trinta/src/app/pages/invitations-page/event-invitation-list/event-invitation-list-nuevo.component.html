<!-- HEADER centrado -->
<div class="header-back">
  <a routerLink="/">
    <img src="assets/images/pages/back-arrow.png" alt="Volver" width="24" height="24" />
  </a>
  <h5 class="mb-0">Reporte de eventos</h5>
</div>

<!-- LISTA -->
<div class="list-wrap">
  <div
    class="visit-card"
    *ngFor="let invitation of dataSource.data | slice:0:displayCount"
    [class.card-disabled]="!invitation.isActive"
  >
    <!-- Píldora de estado -->
    <div
      class="status-pill"
      [ngClass]="invitation.isUsed ? 'used' : (invitation.isActive ? 'active' : 'expired')"
      [attr.aria-label]="invitation.isUsed ? 'Usada' : (invitation.isActive ? 'Activa' : 'Inactiva')"
    >
      <span class="material-symbols-outlined">
        {{ invitation.isUsed ? 'task_alt' : (invitation.isActive ? 'check_circle' : 'block') }}
      </span>
      <span class="txt">
        {{ invitation.isUsed ? 'Usada' : (invitation.isActive ? 'Activa' : 'Inactiva') }}
      </span>
    </div>

    <!-- Encabezado -->
    <div class="head">
      <span class="material-symbols-outlined avatar-ico">celebration</span>
      <div class="who">
        <div class="name">{{ invitation.guestName }}</div>
        <div class="type">Evento</div>
      </div>
    </div>

    <!-- Bloque info -->
    <div class="info">
      <!-- FECHA (día mes – día mes) -->
      <div class="row">
        <span class="material-symbols-outlined ico date">calendar_month</span>
        <div class="col">
          <div class="label">Fecha</div>
          <div class="value">
            {{ invitation.startTime | date:"d 'de' MMMM" : undefined : 'es' }}
            –
            {{ invitation.endTime   | date:"d 'de' MMMM" : undefined : 'es' }}
          </div>
        </div>
      </div>

      <!-- HORARIO (hh:mm a – hh:mm a) -->
      <div class="row">
        <span class="material-symbols-outlined ico time">schedule</span>
        <div class="col">
          <div class="label">Horario</div>
          <div class="value">
            {{ invitation.startTime | date:'hh:mm a' }} – {{ invitation.endTime | date:'hh:mm a' }}
          </div>
        </div>
      </div>

      <!-- DIRECCIÓN -->
      <div class="row">
        <span class="material-symbols-outlined ico addr">home_pin</span>
        <div class="col">
          <div class="label">Locación</div>
          <div class="value">{{ invitation.fullAddress }}</div>
        </div>
      </div>

      <!-- ACCESOS -->
      <div class="row">
        <span class="material-symbols-outlined ico people">groups</span>
        <div class="col">
          <div class="label">Accesos</div>
          <div class="value">{{ invitation.numAccess || 0 }} accesos</div>
        </div>
      </div>
    </div>

    <!-- ACCIÓN principal
         Activa   => Compartir Evento
         Inactiva => Duplicar Evento
    -->
    <div class="actions">
      <button
        *ngIf="invitation.isActive; else duplicateBtn"
        class="full-btn primary"
        type="button"
        (click)="compartir(invitation.token)"
      >
        <span class="material-symbols-outlined">inbox_text_share</span>
        Compartir Evento
      </button>

      <ng-template #duplicateBtn>
        <button
          class="full-btn neutral"
          type="button"
          (click)="onDuplicate(invitation)"
        >
          <span class="material-symbols-outlined">content_copy</span>
          Duplicar Evento
        </button>
      </ng-template>
    </div>
  </div>

  <!-- Ver más -->
  <div class="more" *ngIf="displayCount < dataSource.data.length">
    <button mat-button color="primary" (click)="onViewMore()">Ver más</button>
  </div>
</div>

<!-- FAB crear evento    -->
<button
  class="fab"
  type="button"
  aria-label="Nuevo evento"
  (click)="goToCreate()"
>
  <span class="material-symbols-outlined">add</span>
</button>
